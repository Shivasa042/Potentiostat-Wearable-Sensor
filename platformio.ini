# PlatformIO Configuration for HELPStat Board
# ESP32-S3 with AD5940 Potentiostat Chip
# Project: Electrochemical Impedance Spectroscopy (EIS)

[platformio]
# Default environment
default_envs = helpstat_esp32s3
# Project name
name = HELPStat
# Description
description = Wearable Electrochemical Potentiostat with EIS Capabilities
# Home page
homepage = https://github.com/LinnesLab/HELPStat
# Version
version = 2.0

# ============================================================================
# ESP32-S3 HELPStat Board Configuration
# ============================================================================
[env:helpstat_esp32s3]
platform = espressif32@6.5.0
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200

# Compiler and build options
compiler.c_flags = 
    -Wall
    -Wextra
build_flags = 
    -DARDUINO=10813
    -DARDUINO_ESP32S3_DEV
    -DARDUINO_VARIANT="esp32s3"
    -D CLCK=240000000/16
    -D BITS=MSBFIRST
    -D SPIMODE=SPI_MODE0

# Board-specific settings
board_build.mcu = esp32s3
board_build.f_cpu = 240000000L
board_build.flash_mode = dio
board_build.flash_freq = 80m
board_build.flash_size = 16MB
board_build.psram_type = opi

# Upload settings
upload_speed = 921600
upload_protocol = esptool

# Monitor settings (Serial port)
monitor_port = COM3
monitor_echo = yes

# Libraries
lib_deps = 
    # Bluetooth/BLE
    BLEDevice
    BLEServer
    BLEUtils
    BLEScan
    # File system/SD Card
    SD
    FS
    # SPI
    SPI
    # Built-in (Arduino framework)
    
# Include paths (uses default lib/ folder)
lib_ldf_mode = deep

# Ignore certain patterns
lib_ignore = 
    Example

# Source filters (what to compile)
src_filter = 
    +<*>
    -<.git/>
    -<.pio/>
    -<docs/>

# Build output
build_dir = .pio/build/helpstat_esp32s3

# ============================================================================
# Development Environment (with Serial Monitor)
# ============================================================================
[env:helpstat_esp32s3_dev]
; Inherits from base environment
extends = helpstat_esp32s3
; Enable additional debugging
build_type = debug
; Use debug symbols
build_flags = ${env:helpstat_esp32s3.build_flags}
    -g
    -O0

# ============================================================================
# Testing Environment
# ============================================================================
[env:helpstat_esp32s3_test]
extends = helpstat_esp32s3
build_type = debug
monitor_echo = yes

# ============================================================================
# Alternative: ESP32-S3 FEATHER (if using Adafruit Feather)
# Uncomment to use instead
# ============================================================================
#[env:helpstat_feather_s3]
#platform = espressif32
#board = adafruit_feather_esp32s3
#framework = arduino
#upload_speed = 921600
#monitor_speed = 115200
#lib_extra_dirs = ./Software/HELPStatLib
#src_filter = +<*> -<.git/> -<.pio/> -<docs/>
